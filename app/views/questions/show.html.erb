<%= provide(:title, "#{@question.school.name}の質問と回答") %>
<div class="question-show background-blue" id="question--show">
  <%= render partial: 'question_show_page_link', locals: { params: @params, question: @question } %>
  <%= render 'shared/flash_message' %>
  <div class="question-show-field">
    <div class="question-content">
      <h2><%= @question.school.name %>の質問と回答</h2>
      <% if @question.solution == 0 %>
        <div class="solution solution-red">
          未回答
        </div>
      <% elsif @question.solution == 1 %>
        <div class="solution solution-orange">
          未解決
        </div>
      <% else %>
        <div class="solution solution-green">
          解決済み
        </div>
      <% end %>
      <%= render partial: 'question_show_question_box', locals: { question: @question, params: @params } %>
      <% unless @answers.size == 0 %>
        <span class="rotateY180">&#8629;</span>
        <span class="span-answer">回答</span>
      <% end %>
      <%= render partial: 'question_show_answer_box', collection: @answers, as: :answer %>
      <% if user_signed_in? %>
        <%= label :content, "回答欄", class: "label-answer" %>
        <div class="question-box answer-textarea-box">
          <%= form_with model: @answer, url: answers_path, local: true do |f| %>
            <%= render 'shared/error_messages', object: f.object %>
            <%= f.text_area :content, placeholder: "回答を入力してください", class: "resize10" %>

            <%= f.hidden_field :user_id, value: current_user.id %>
            <%= f.hidden_field :question_id, value: @question.id %>

            <%= f.submit '回答する', class: "submit-button" %>
          <% end %>
        </div>
        <% if current_user == @question.user %>
          <% if @question.solution == 0 || @question.solution == 1 %>
            <div class="question-box solution-box">
              <p>質問が解決したらボタンを押してください</p>
              <%= link_to "解決した", solved_path(question_id: @question.id), class: "button" %>
            </div>
          <% else %>
            <div class="question-box solution-box">
              <p>追加の質問がある場合にはボタンを押してください</p>
              <%= link_to "解決済み", solved_path(question_id: @question.id), class: "button unsolution" %>
            </div>
          <% end %>
        <% end %>
      <% end %>
      <%= link_to "戻る", questions_path(school_id: @question.school_id), class: "button" %>
    </div>
  </div>
</div>
