<%= provide(:title, "通知一覧")%>
<%= render 'shared/flash_message' %>
<div class="notification-index">
  <div class="all-notification-box">
    <h2 class="">通知</h2>
    <% if @notifications.exists? %>
      <%= link_to destroy_all_notification_path(user_id: @notifications.first.visited.id), method: :delete, data: {confirm: "通知を全て削除しますか？"}, class: "all-notifications-delete" do %>
        <i class="fa fa-trash" aria-hidden="true"></i>全削除
      <% end %>
      <div class="">
        <% @notifications.each do |notification| %>
          <div class="one-notification-box">
            <% if notification.action == "like" %>
              <div class="one-notification-box-flex">
                <%= link_to user_path(notification.visiter) do %>
                  <% if notification.visiter.image.attached? %>
                    <%= image_tag notification.visiter.image.variant(resize: '40x40!'), class: "user-icon", alt: "ユーザーアイコン" %>
                  <% else %>
                    <%= image_tag src='70b3dd52350bf605f1bb4078ef79c9b9.png', class: "user-icon-default", alt: "ユーザーアイコン" %>
                  <% end %>
                <% end %>
                <div class="notification-title">
                  <%= link_to notification.visiter.name, user_path(notification.visiter), class: "notification-link" %>が
                  <%= link_to 'あなたの口コミ', review_path(notification.review), class: "notification-link" %>にいいねしました。
                  <%= "(#{notification.how_long_ago})" %>
                </div>
                <%= link_to "削除", notification_path(notification), method: :delete, data: {confirm: "この通知を削除しますか？"}, class: "notification-like-delete" %>
              </div>
              <p class="notification-content"><%= notification.review.name %></p>
            <% elsif notification.action == "answer" %>
              <div class="one-notification-box-flex">
                <%= link_to user_path(notification.visiter) do %>
                  <% if notification.visiter.image.attached? %>
                    <%= image_tag notification.visiter.image.variant(resize: '40x40!'), class: "user-icon", alt: "ユーザーアイコン" %>
                  <% else %>
                    <%= image_tag src='70b3dd52350bf605f1bb4078ef79c9b9.png', class: "user-icon-default", alt: "ユーザーアイコン" %>
                  <% end %>
                <% end %>
                <div class="notification-title">
                  <%= link_to notification.visiter.name, user_path(notification.visiter), class: "notification-link" %>が
                  <%= link_to 'あなたの質問', question_path(notification.question), class: "notification-link" %>に回答しました。
                  <%= "(#{notification.how_long_ago})" %>
                </div>
                <%= link_to "削除", notification_path(notification), method: :delete, data: {confirm: "この通知を削除しますか？"}, class: "notification-answer-delete" %>
              </div>
              <%= simple_format(notification.answer.content.truncate(20), class: "notification-content") %>
            <% end %>
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="not-notification">通知はありません</p>
    <% end %>
    <% unless (will_paginate @notifications).nil? %>
      <div class="paginate">
        <%= will_paginate @notifications, :previous_label => ' &lt 前へ', :next_label => '次へ &gt' %>
      </div>
    <% end %>
  </div>
</div>
